<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sipp Sipp â€“ Partyspel</title>
<style>
body {
  margin:0;
  font-family:Arial,sans-serif;
  background:linear-gradient(to bottom,#ff8a00,#e52e71);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  color:white;
}

.game-container {
  background: rgba(0,0,0,0.5);
  padding:30px;
  border-radius:20px;
  text-align:center;
  max-width:400px;
  width:90%;
  position:relative;
}

h1 { margin-bottom:20px; }

#statement {
  font-size:1.2rem;
  margin-bottom:20px;
  min-height:50px;
  transition: opacity 0.5s;
}

.fade-out { opacity:0; }
.fade-in { opacity:1; }

.players-list { text-align:left; margin-bottom:20px; }

/* Snygga markeringar */
.players-list label {
  display: flex;
  align-items: center;
  cursor: pointer;
  margin-bottom: 10px;
  user-select: none;
}

.players-list input[type="checkbox"] {
  display: none;
}

.players-list .checkbox-custom {
  width: 25px;
  height: 25px;
  border: 2px solid white;
  border-radius: 8px;
  margin-right: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.players-list .checkbox-custom.checked {
  background-color: #ff8a00;
  border-color: #ff8a00;
}

.players-list .checkbox-custom svg {
  display: none;
  width: 16px;
  height: 16px;
  stroke: white;
  stroke-width: 2;
}

.players-list .checkbox-custom.checked svg {
  display: block;
}

#submitBtn {
  padding:15px 30px;
  font-size:1.2rem;
  background:#fff;
  color:#e52e71;
  border:none;
  border-radius:12px;
  font-weight:bold;
  cursor:pointer;
  transition:0.3s;
}
#submitBtn:hover { background:#ff8a00; color:white; }

#scoreBoard { margin-top:20px; text-align:center; }
.score-item {
  margin-bottom:8px;
  font-size:1.1rem;
  background:rgba(255,255,255,0.2);
  padding:6px;
  border-radius:10px;
  position:relative;
}

/* FÃ¶rÃ¤ndring: vinnare */
.winner {
  border: 2px solid gold;
  font-weight: bold;
  background: rgba(255,215,0,0.3);
  animation: pulse 1.5s infinite;
}

.score-change {
  font-size:0.9rem;
  color:#00ff00;
  margin-left:6px;
}

.back-button {
  position:absolute;
  top:20px;
  left:20px;
  display:flex;
  align-items:center;
  justify-content:center;
  width:50px;
  height:50px;
  background: rgba(0,0,0,0.3);
  border-radius:12px;
  transition: background 0.3s;
  text-decoration:none;
  z-index:10;
}
.back-button:hover { background: rgba(0,0,0,0.6); }
.back-button svg { width:24px; height:24px; }

/* Puls-animation */
@keyframes pulse {
  0% { transform: scale(1); box-shadow: 0 0 5px gold; }
  50% { transform: scale(1.05); box-shadow: 0 0 20px gold; }
  100% { transform: scale(1); box-shadow: 0 0 5px gold; }
}
</style>
</head>
<body>

<a href="spelare-klunk.html" class="back-button">
  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M15 18L9 12L15 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
</a>

<div class="game-container">
  <h1>Sipp Sipp â€“ Partyspel</h1>
  <div id="statement">Laddar pÃ¥stÃ¥ende...</div>

  <div class="players-list" id="playersList"></div>
  <button id="submitBtn">âœ”</button>
  <div id="scoreBoard"></div>
</div>

<script>
const players = JSON.parse(localStorage.getItem("sippPlayers")) || [];
if(players.length===0) alert("Inga spelare hittades! GÃ¥ tillbaka och lÃ¤gg till spelare fÃ¶rst.");

const scores = {};
players.forEach(p => scores[p]=0);

const statements = [
"Vem har kÃ¶rt bil full? \nDen dricker x klunkar",
"Vem har skickat nakenbilder? \nDen dricker x klunkar",
"Vem har ljugit fÃ¶r sin bÃ¤sta vÃ¤n? \nDen dricker x klunkar",
"Vem har blivit kÃ¤r vid fÃ¶rsta Ã¶gonkastet? \nDen dricker x klunkar",
"Vem har fÃ¥tt sparken? \nDen dricker x klunkar",
"Vem har haft sex pÃ¥ offentlig plats? \nDen dricker x klunkar",
"Vem har fuskat pÃ¥ ett prov? \nDen dricker x klunkar",
"Vem har grÃ¥tit av skratt? \nDen dricker x klunkar",
"Vem har kysst mer Ã¤n 5 personer? \nDen dricker x klunkar",
"Vem har blivit dumpad via sms? \nDen dricker x klunkar",
"Vem har lÃ¥tsats vara sjuk fÃ¶r att slippa nÃ¥got? \nDen dricker x klunkar",
"Vem har haft en one-night-stand? \nDen dricker x klunkar",
"Vem har stalkat nÃ¥gon pÃ¥ sociala medier? \nDen dricker x klunkar",
"Vem har rÃ¥kat skicka ett sms till fel person? \nDen dricker x klunkar",
"Vem har brÃ¥kat med sina fÃ¶rÃ¤ldrar? \nDen dricker x klunkar",
"Vem har kÃ¶rt gokart? \nDen dricker x klunkar",
"Vem har tagit nakenbilder pÃ¥ sig sjÃ¤lv? \nDen dricker x klunkar",
"Vem har blivit tagen pÃ¥ bar gÃ¤rning? \nDen dricker x klunkar",
"Vem har haft sexdrÃ¶mmar om nÃ¥gon hÃ¤r? \nDen dricker x klunkar",
"Vem har skickat pinsamma meddelanden till fel person? \nDen dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"Vem har varit full pÃ¥ jobbet? \nDen dricker x klunkar",
"Vem har blivit kÃ¤r i en lÃ¤rare? \nDen dricker x klunkar",
"Vem har kysst nÃ¥gon av samma kÃ¶n? \nDen dricker x klunkar",
"Vem har ljugit om sin Ã¥lder? \nDen dricker x klunkar",
"Vem har fÃ¥tt bÃ¶ter? \nDen dricker x klunkar",
"Vem har spelat naken? \nDen dricker x klunkar",
"Vem har rÃ¥kat skicka nakenbilder till fel person? \nDen dricker x klunkar",
"Vem har varit med i ett slagsmÃ¥l? \nDen dricker x klunkar",
"Vem har varit otrogen? \nDen dricker x klunkar",
"Vem har kysst en frÃ¤mling? \nDen dricker x klunkar",
"Vem har blivit jagad av polisen? \nDen dricker x klunkar",
"Vem har brutit nÃ¥got hemma? \nDen dricker x klunkar",
"Vem har varit pÃ¥ en stripklubb? \nDen dricker x klunkar",
"Vem har blivit dumpad via telefon? \nDen dricker x klunkar",
"Vem har smygit in pÃ¥ en fest? \nDen dricker x klunkar",
"Vem har haft pinsamt sex? \nDen dricker x klunkar",
"Vem har ljugit om pengar? \nDen dricker x klunkar",
"Vem har grÃ¥tit pÃ¥ offentliga platser? \nDen dricker x klunkar",
"Vem har kysst nÃ¥gon i regnet? \nDen dricker x klunkar",
"Vem har blivit av med sin mobil? \nDen dricker x klunkar",
"Vem har glÃ¶mt en kompis fÃ¶delsedag? \nDen dricker x klunkar",
"Vem har skickat smygbilder? \nDen dricker x klunkar",
"Vem har blivit kÃ¤r i fel person? \nDen dricker x klunkar",
"Vem har ljugit fÃ¶r sin partner? \nDen dricker x klunkar",
"Vem har raggat pÃ¥ nÃ¥gon hÃ¤r? \nDen dricker x klunkar",
"Vem har haft en crush pÃ¥ en vÃ¤ns partner? \nDen dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"Vem har blivit avvisad pÃ¥ Tinder? \nDen dricker x klunkar",
"Vem har kysst nÃ¥gon pÃ¥ en fest? \nDen dricker x klunkar",
"Vem har ljugit om sin relation? \nDen dricker x klunkar",
"Vem har blivit kÃ¤r i en kollega? \nDen dricker x klunkar",
"Vem har tagit selfies i badrummet? \nDen dricker x klunkar",
"Vem har glÃ¶mt nÃ¥gons namn direkt efter att de trÃ¤ffats? \nDen dricker x klunkar",
"Vem har snattat nÃ¥got? \nDen dricker x klunkar",
"Vem har lÃ¥tsats gilla nÃ¥got de hatade? \nDen dricker x klunkar",
"Vem har smyglyssnat pÃ¥ nÃ¥gon annans samtal? \nDen dricker x klunkar",
"Vem har skrivit pinsamma DM till kÃ¤ndisar? \nDen dricker x klunkar",
"Vem har gÃ¥tt in i fel lÃ¤genhet/hus av misstag? \nDen dricker x klunkar",
"Vem har glÃ¶mt sina nycklar nÃ¥gonstans? \nDen dricker x klunkar",
"Vem har rÃ¥kat avslÃ¶ja en hemlighet? \nDen dricker x klunkar",
"Sten, sax, pÃ¥se\nFÃ¶rloraren dricker x klunkar",
"Sista personen som tar handen frÃ¥n bordet\nDricker x klunkar",
"Alla som har pÃ¥ sig blÃ¥tt\nDricker x klunkar",
"Den som skrattar fÃ¶rst pÃ¥ skÃ¤mtet\nDricker x klunkar",
"Den som sÃ¤ger 'ja' fÃ¶rst\nDricker x klunkar",
"Snabbast att rÃ¤kna till tio\nFÃ¶rloraren dricker x klunkar",
"Den som glÃ¶mmer sin tur\nDricker x klunkar",
"Alla som har husdjur\nDricker x klunkar",
"Den som inte kan sÃ¤ga alfabetet baklÃ¤nges\nDricker x klunkar",
"FÃ¶rloraren i tÃ¤rningskastet\nDricker x klunkar",
"Den som inte kan vissla\nDricker x klunkar",
"Den som fÃ¶rst gÃ¶r en high five med {name}\nDricker x klunkar",
"Alla som har en bror eller syster\nDricker x klunkar",
"Den som blundar lÃ¤ngst\nFÃ¶rloraren dricker x klunkar",
"Den som fÃ¶rst hinner sÃ¤ga sitt eget namn baklÃ¤nges\nDricker x klunkar",
"Den som inte kan hoppa tre gÃ¥nger utan att snubbla\nDricker x klunkar",
"Den som inte hittar sina skor snabbast\nDricker x klunkar",
"Den som inte kan vifta med Ã¶ronen\nDricker x klunkar",
"Alla som har glasÃ¶gon pÃ¥ sig\nDricker x klunkar",
"Den som inte kan vissla melodin rÃ¤tt\nDricker x klunkar",
"Den som inte kan gÃ¶ra en bakÃ¥tkullerbytta\nDricker x klunkar",
"Den som inte kan rÃ¤kna baklÃ¤nges frÃ¥n 20\nDricker x klunkar",
"Alla som har mer Ã¤n tvÃ¥ syskon\nDricker x klunkar",
"Den som kan knyta sina skor snabbast\nDelar ut x klunkar",
"Alla som gillar choklad\nDricker x klunkar",
"Den som inte kan vissla och blinka samtidigt\nDricker x klunkar",
"Den som fÃ¶rst ramlar under stol-leken\nDricker x klunkar",
"Den som inte kan hoppa pÃ¥ ett ben 10 gÃ¥nger\nDricker x klunkar",
"Den som glÃ¶mmer reglerna fÃ¶rst\nDricker x klunkar",
"Alla som har husdjur som katt\nDricker x klunkar",
"Den som inte kan sÃ¤ga 'rÃ¶d lÃ¶k' tre gÃ¥nger snabbt\nDricker x klunkar",
"Den som fÃ¶rst skrattar Ã¥t sin egen skÃ¤mt\nDricker x klunkar",
"Rimleken\nDen som fÃ¶rst rÃ¥kar sÃ¤ga fel ord\nDricker x klunkar",
"Alla som har tatueringar\nDricker x klunkar",
"Den som kan hÃ¥lla balans pÃ¥ ett ben lÃ¤ngst\nDelar ut x klunkar",
"Den som kÃ¶rde bil sist\nDelar ut x klunkar",
"Den som skickade sms sist\nDelar ut x klunkar",
"Den som Ã¥t sist\nDelar ut x klunkar",
"Den som gick upp tidigast idag\nDelar ut x klunkar",
"Den som tog en selfie sist\nDelar ut x klunkar",
"Den som skrattade sist\nDelar ut x klunkar",
"Den som sov mest igÃ¥r\nDelar ut x klunkar",
"Den som drack kaffe sist\nDelar ut x klunkar",
"Den som Ã¥t mest idag\nDelar ut x klunkar",
"Den som var pÃ¥ toaletten sist\nDelar ut x klunkar",
"Den som kollade telefonen sist\nDelar ut x klunkar",
"Den som stÃ¤dade sist\nDelar ut x klunkar",
"Den som kÃ¶rde mest bil den hÃ¤r veckan\nDelar ut x klunkar",
"Den som handlade sist\nDelar ut x klunkar",
"Den som duschade sist\nDelar ut x klunkar",
"Den som sa ett roligaste skÃ¤mt sist\nDelar ut x klunkar",
"Den som var pÃ¥ fest sist\nDelar ut x klunkar",
"Den som skrev ett meddelande sist\nDelar ut x klunkar",
"Den som kollade TV sist\nDelar ut x klunkar",
"Den som var pÃ¥ sociala medier sist\nDelar ut x klunkar",
"Den som drack alkohol sist\nDelar ut x klunkar",
"Den som lagade mat sist\nDelar ut x klunkar",
"Den som kom till festen sist\nDelar ut x klunkar",
"Den som spelade dator sist\nDelar ut x klunkar",
"Den som kÃ¶pte nÃ¥got sist\nDelar ut x klunkar",
"Den som lÃ¤ste en bok sist\nDelar ut x klunkar",
"Den som var ute och gick sist\nDelar ut x klunkar",
"Den som lyssnade pÃ¥ musik sist\nDelar ut x klunkar",
"Den som kollade vÃ¤dret sist\nDelar ut x klunkar",
"Den som ringde nÃ¥gon sist\nDelar ut x klunkar"
];

const games = ["Monopol", "Fia med knuff", "UNO", "Klunk", "Poker", 
"Bingo", "Cluedo", "Twister", "Charader", "Sipp Sipp Play", "Pictionary", "Risk", "Settlers of Catan", "Trivial Pursuit", "Sipp Sipp", "Kubb"];

const statementDiv = document.getElementById("statement");
const playersListDiv = document.getElementById("playersList");
const submitBtn = document.getElementById("submitBtn");
const scoreBoardDiv = document.getElementById("scoreBoard");

let currentX = 0;
let lastGains = {};
let lastStatement = ""; // ðŸ‘ˆ fÃ¶r att undvika upprepning

function renderPlayers() {
  playersListDiv.innerHTML="";
  players.forEach(p => {
    const label = document.createElement("label");
    label.innerHTML = `
      <input type="checkbox" value="${p}">
      <div class="checkbox-custom">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 13L9 17L19 7" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      ${p}
    `;
    playersListDiv.appendChild(label);

    const input = label.querySelector("input");
    const customBox = label.querySelector(".checkbox-custom");

    input.addEventListener("change", () => {
      if(input.checked) customBox.classList.add("checked");
      else customBox.classList.remove("checked");
    });
  });
}

function updateScores() {
  scoreBoardDiv.innerHTML="";
  const maxScore = Math.max(...Object.values(scores));

  players.forEach(p=>{
    const div=document.createElement("div");
    div.className="score-item";
    div.innerHTML=`${p}: ${scores[p]} poÃ¤ng`;

    if(scores[p] === maxScore && maxScore > 0){
      div.classList.add("winner");
    }

    if(lastGains[p]>0){
      const gainSpan=document.createElement("span");
      gainSpan.className="score-change";
      gainSpan.textContent=`+${lastGains[p]}`;
      div.appendChild(gainSpan);
    }
    scoreBoardDiv.appendChild(div);
  });
}

function newStatement(){
  statementDiv.classList.add("fade-out");
  setTimeout(() => {
    let statement;
    do {
      statement = statements[Math.floor(Math.random() * statements.length)];
    } while (statement === lastStatement); // ðŸ‘ˆ undvik samma 2 ggr i rad
    lastStatement = statement;

    const x = Math.floor(Math.random() * 5) + 1;

    if(statement.includes("x")) statement = statement.replace(/x/g, x);
    if(statement.includes("{name}") && players.length > 0){
      const randomPlayer = players[Math.floor(Math.random() * players.length)];
      statement = statement.replace(/{name}/g, randomPlayer);
    }
    if(statement.includes("{game}")) {
      const randomGame = games[Math.floor(Math.random() * games.length)];
      statement = statement.replace(/{game}/g, randomGame);
    }

    statementDiv.innerHTML = statement.replace(/\n/g, "<br>");

    document.querySelectorAll("#playersList input[type=checkbox]").forEach(cb => cb.checked = false);
    document.querySelectorAll(".checkbox-custom").forEach(box => box.classList.remove("checked"));

    statementDiv.classList.remove("fade-out");
    statementDiv.classList.add("fade-in");
    setTimeout(() => statementDiv.classList.remove("fade-in"), 500);

    currentX = x;
    lastGains = {};
  }, 500);
}

submitBtn.addEventListener("click", () => {
  const selected=[];
  document.querySelectorAll("#playersList input[type=checkbox]:checked")
    .forEach(cb=>selected.push(cb.value));

  // Om ingen Ã¤r vald â†’ gÃ¥ vidare utan poÃ¤ng
  if(selected.length === 0){
    lastGains = {}; // inga +poÃ¤ng att visa
    updateScores();
    newStatement();
    return;
  }

  // Annars ge poÃ¤ng som vanligt
  selected.forEach(p=>{
    scores[p]+=currentX;
    lastGains[p]=currentX;
  });
  updateScores();
  newStatement();
});


renderPlayers();
updateScores();
newStatement();
</script>
</body>
</html>

