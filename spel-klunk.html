<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sipp Sipp – Partyspel</title>
<style>
body {
  margin:0;
  font-family:Arial,sans-serif;
  background:linear-gradient(to bottom,#ff8a00,#e52e71);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  color:white;
  flex-direction: column;
}

.game-container {
  background: rgba(0,0,0,0.5);
  padding:30px;
  border-radius:20px;
  text-align:center;
  max-width:400px;
  width:90%;
  position:relative;
}

h1 { margin-bottom:20px; }

#statement {
  font-size:1.2rem;
  margin-bottom:20px;
  min-height:50px;
  transition: opacity 0.5s;
}

.fade-out { opacity:0; }
.fade-in { opacity:1; }

.players-list { text-align:left; margin-bottom:20px; }

.players-list label {
  display: flex;
  align-items: center;
  cursor: pointer;
  margin-bottom: 10px;
  user-select: none;
}

.players-list input[type="checkbox"] { display: none; }

.players-list .checkbox-custom {
  width: 25px;
  height: 25px;
  border: 2px solid white;
  border-radius: 8px;
  margin-right: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.players-list .checkbox-custom.checked {
  background-color: #ff8a00;
  border-color: #ff8a00;
}

.players-list .checkbox-custom svg {
  display: none;
  width: 16px;
  height: 16px;
  stroke: white;
  stroke-width: 2;
}

.players-list .checkbox-custom.checked svg {
  display: block;
}

#submitBtn, #resetBtn {
  padding:15px 30px;
  font-size:1.2rem;
  background:#fff;
  color:#e52e71;
  border:none;
  border-radius:12px;
  font-weight:bold;
  cursor:pointer;
  transition:0.3s;
  margin-top:10px;
}
#submitBtn:hover, #resetBtn:hover { background:#ff8a00; color:white; }

#scoreBoard { margin-top:20px; text-align:center; }
.score-item {
  margin-bottom:8px;
  font-size:1.1rem;
  background:rgba(255,255,255,0.2);
  padding:6px;
  border-radius:10px;
  position:relative;
}

.winner-gold {
  border: 2px solid gold;
  font-weight: bold;
  background: rgba(255,215,0,0.3);
  animation: pulse-gold 1.5s infinite;
}
.winner-silver {
  border: 2px solid silver;
  font-weight: bold;
  background: rgba(192,192,192,0.3);
  animation: pulse-silver 1.5s infinite;
}
.winner-bronze {
  border: 2px solid #cd7f32;
  font-weight: bold;
  background: rgba(205,127,50,0.3);
  animation: pulse-bronze 1.5s infinite;
}

.score-change {
  font-size:1rem;
  color:#00ff00;
  margin-left:6px;
  position:absolute;
  right:10px;
  top:50%;
  transform:translateY(-50%);
  animation: jump 1s ease-out forwards;
}

@keyframes jump {
  0% { opacity:1; transform: translateY(0); }
  50% { opacity:1; transform: translateY(-20px); }
  100% { opacity:0; transform: translateY(-40px); }
}

.back-button {
  position:absolute;
  top:20px;
  left:20px;
  display:flex;
  align-items:center;
  justify-content:center;
  width:50px;
  height:50px;
  background: rgba(0,0,0,0.3);
  border-radius:12px;
  transition: background 0.3s;
  text-decoration:none;
  z-index:10;
}
.back-button:hover { background: rgba(0,0,0,0.6); }
.back-button svg { width:24px; height:24px; }

@keyframes pulse-gold {
  0% { transform: scale(1); box-shadow: 0 0 5px gold; }
  50% { transform: scale(1.05); box-shadow: 0 0 20px gold; }
  100% { transform: scale(1); box-shadow: 0 0 5px gold; }
}
@keyframes pulse-silver {
  0% { transform: scale(1); box-shadow: 0 0 5px silver; }
  50% { transform: scale(1.05); box-shadow: 0 0 20px silver; }
  100% { transform: scale(1); box-shadow: 0 0 5px silver; }
}
@keyframes pulse-bronze {
  0% { transform: scale(1); box-shadow: 0 0 5px #cd7f32; }
  50% { transform: scale(1.05); box-shadow: 0 0 20px #cd7f32; }
  100% { transform: scale(1); box-shadow: 0 0 5px #cd7f32; }
}

.confetti {
  position: fixed;
  width: 10px;
  height: 10px;
  top: 0;
  animation: fall 3s linear infinite;
  opacity: 0.8;
  z-index: 9999;
}

@keyframes fall {
  0% { transform: translateY(0) rotate(0deg); }
  100% { transform: translateY(100vh) rotate(360deg); }
}
</style>
</head>
<body>

<a href="spelare-klunk.html" class="back-button">
  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M15 18L9 12L15 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
</a>

<div class="game-container">
  <h1>Sipp Sipp – Partyspel</h1>
  <div id="statement">Laddar påstående...</div>
  <div class="players-list" id="playersList"></div>
  <button id="submitBtn">✔</button>
  <div id="scoreBoard"></div>
  <button id="resetBtn">Återställ poäng</button>
</div>

<script>
const players = JSON.parse(localStorage.getItem("sippPlayers")) || [];
if(players.length===0) alert("Inga spelare hittades! Gå tillbaka och lägg till spelare först.");

const scores = {};
players.forEach(p => scores[p] = 0);

const statements = [
"Vem har kört bil full? \nDen dricker x klunkar",
"Vem har skickat nakenbilder? \nDen dricker x klunkar",
"Vem har ljugit för sin bästa vän? \nDen dricker x klunkar",
"Vem har blivit kär vid första ögonkastet? \nDen dricker x klunkar",
"Vem har fått sparken? \nDen dricker x klunkar",
"Vem har haft sex på offentlig plats? \nDen dricker x klunkar",
"Vem har fuskat på ett prov? \nDen dricker x klunkar",
"Vem har gråtit av skratt? \nDen dricker x klunkar",
"Vem har kysst mer än 5 personer? \nDen dricker x klunkar",
"Vem har blivit dumpad via sms? \nDen dricker x klunkar",
"Vem har låtsats vara sjuk för att slippa något? \nDen dricker x klunkar",
"Vem har haft en one-night-stand? \nDen dricker x klunkar",
"Vem har stalkat någon på sociala medier? \nDen dricker x klunkar",
"Vem har råkat skicka ett sms till fel person? \nDen dricker x klunkar",
"Vem har bråkat med sina föräldrar? \nDen dricker x klunkar",
"Vem har kört gokart? \nDen dricker x klunkar",
"Vem har tagit nakenbilder på sig själv? \nDen dricker x klunkar",
"Vem har blivit tagen på bar gärning? \nDen dricker x klunkar",
"Vem har haft sexdrömmar om någon här? \nDen dricker x klunkar",
"Vem har skickat pinsamma meddelanden till fel person? \nDen dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"Vem har varit full på jobbet? \nDen dricker x klunkar",
"Vem har blivit kär i en lärare? \nDen dricker x klunkar",
"Vem har kysst någon av samma kön? \nDen dricker x klunkar",
"Vem har ljugit om sin ålder? \nDen dricker x klunkar",
"Vem har fått böter? \nDen dricker x klunkar",
"Vem har spelat naken? \nDen dricker x klunkar",
"Vem har råkat skicka nakenbilder till fel person? \nDen dricker x klunkar",
"Vem har varit med i ett slagsmål? \nDen dricker x klunkar",
"Vem har varit otrogen? \nDen dricker x klunkar",
"Vem har kysst en främling? \nDen dricker x klunkar",
"Vem har blivit jagad av polisen? \nDen dricker x klunkar",
"Vem har brutit något hemma? \nDen dricker x klunkar",
"Vem har varit på en stripklubb? \nDen dricker x klunkar",
"Vem har blivit dumpad via telefon? \nDen dricker x klunkar",
"Vem har smygit in på en fest? \nDen dricker x klunkar",
"Vem har haft pinsamt sex? \nDen dricker x klunkar",
"Vem har ljugit om pengar? \nDen dricker x klunkar",
"Vem har gråtit på offentliga platser? \nDen dricker x klunkar",
"Vem har kysst någon i regnet? \nDen dricker x klunkar",
"Vem har blivit av med sin mobil? \nDen dricker x klunkar",
"Vem har glömt en kompis födelsedag? \nDen dricker x klunkar",
"Vem har skickat smygbilder? \nDen dricker x klunkar",
"Vem har blivit kär i fel person? \nDen dricker x klunkar",
"Vem har ljugit för sin partner? \nDen dricker x klunkar",
"Vem har raggat på någon här? \nDen dricker x klunkar",
"Vem har haft en crush på en väns partner? \nDen dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"{name} dricker x klunkar",
"Vem har blivit avvisad på Tinder? \nDen dricker x klunkar",
"Vem har kysst någon på en fest? \nDen dricker x klunkar",
"Vem har ljugit om sin relation? \nDen dricker x klunkar",
"Vem har blivit kär i en kollega? \nDen dricker x klunkar",
"Vem har tagit selfies i badrummet? \nDen dricker x klunkar",
"Vem har glömt någons namn direkt efter att de träffats? \nDen dricker x klunkar",
"Vem har snattat något? \nDen dricker x klunkar",
"Vem har låtsats gilla något de hatade? \nDen dricker x klunkar",
"Vem har smyglyssnat på någon annans samtal? \nDen dricker x klunkar",
"Vem har skrivit pinsamma DM till kändisar? \nDen dricker x klunkar",
"Vem har gått in i fel lägenhet/hus av misstag? \nDen dricker x klunkar",
"Vem har glömt sina nycklar någonstans? \nDen dricker x klunkar",
"Vem har råkat avslöja en hemlighet? \nDen dricker x klunkar",
"Sten, sax, påse\nFörloraren dricker x klunkar",
"Sista personen som tar handen från bordet\nDricker x klunkar",
"Alla som har på sig blått\nDricker x klunkar",
"Den som skrattar först på skämtet\nDricker x klunkar",
"Den som säger 'ja' först\nDricker x klunkar",
"Snabbast att räkna till tio\nFörloraren dricker x klunkar",
"Den som glömmer sin tur\nDricker x klunkar",
"Alla som har husdjur\nDricker x klunkar",
"Den som inte kan säga alfabetet baklänges\nDricker x klunkar",
"Förloraren i tärningskastet\nDricker x klunkar",
"Den som inte kan vissla\nDricker x klunkar",
"Den som först gör en high five med {name}\nDricker x klunkar",
"Alla som har en bror eller syster\nDricker x klunkar",
"Den som blundar längst\nFörloraren dricker x klunkar",
"Den som först hinner säga sitt eget namn baklänges\nDricker x klunkar",
"Den som inte kan hoppa tre gånger utan att snubbla\nDricker x klunkar",
"Den som inte hittar sina skor snabbast\nDricker x klunkar",
"Den som inte kan vifta med öronen\nDricker x klunkar",
"Alla som har glasögon på sig\nDricker x klunkar",
"Den som inte kan vissla melodin rätt\nDricker x klunkar",
"Den som inte kan göra en bakåtkullerbytta\nDricker x klunkar",
"Den som inte kan räkna baklänges från 20\nDricker x klunkar",
"Alla som har mer än två syskon\nDricker x klunkar",
"Den som kan knyta sina skor snabbast\nDelar ut x klunkar",
"Alla som gillar choklad\nDricker x klunkar",
"Den som inte kan vissla och blinka samtidigt\nDricker x klunkar",
"Den som först ramlar under stol-leken\nDricker x klunkar",
"Den som inte kan hoppa på ett ben 10 gånger\nDricker x klunkar",
"Den som glömmer reglerna först\nDricker x klunkar",
"Alla som har husdjur som katt\nDricker x klunkar",
"Den som inte kan säga 'röd lök' tre gånger snabbt\nDricker x klunkar",
"Den som först skrattar åt sin egen skämt\nDricker x klunkar",
"Rimleken\nDen som först råkar säga fel ord\nDricker x klunkar",
"Alla som har tatueringar\nDricker x klunkar",
"Den som kan hålla balans på ett ben längst\nDelar ut x klunkar",
"Den som körde bil sist\nDelar ut x klunkar",
"Den som skickade sms sist\nDelar ut x klunkar",
"Den som åt sist\nDelar ut x klunkar",
"Den som gick upp tidigast idag\nDelar ut x klunkar",
"Den som tog en selfie sist\nDelar ut x klunkar",
"Den som skrattade sist\nDelar ut x klunkar",
"Den som sov mest igår\nDelar ut x klunkar",
"Den som drack kaffe sist\nDelar ut x klunkar",
"Den som åt mest idag\nDelar ut x klunkar",
"Den som var på toaletten sist\nDelar ut x klunkar",
"Den som kollade telefonen sist\nDelar ut x klunkar",
"Den som städade sist\nDelar ut x klunkar",
"Den som körde mest bil den här veckan\nDelar ut x klunkar",
"Den som handlade sist\nDelar ut x klunkar",
"Den som duschade sist\nDelar ut x klunkar",
"Den som sa ett roligaste skämt sist\nDelar ut x klunkar",
"Den som var på fest sist\nDelar ut x klunkar",
"Den som skrev ett meddelande sist\nDelar ut x klunkar",
"Den som kollade TV sist\nDelar ut x klunkar",
"Den som var på sociala medier sist\nDelar ut x klunkar",
"Den som drack alkohol sist\nDelar ut x klunkar",
"Den som lagade mat sist\nDelar ut x klunkar",
"Den som kom till festen sist\nDelar ut x klunkar",
"Den som spelade dator sist\nDelar ut x klunkar",
"Den som köpte något sist\nDelar ut x klunkar",
"Den som läste en bok sist\nDelar ut x klunkar",
"Den som var ute och gick sist\nDelar ut x klunkar",
"Den som lyssnade på musik sist\nDelar ut x klunkar",
"Den som kollade vädret sist\nDelar ut x klunkar",
"Den som ringde någon sist\nDelar ut x klunkar"
];

const statementDiv = document.getElementById("statement");
const playersListDiv = document.getElementById("playersList");
const submitBtn = document.getElementById("submitBtn");
const scoreBoardDiv = document.getElementById("scoreBoard");
const resetBtn = document.getElementById("resetBtn");

let remainingStatements = [...statements];
let currentX = 0;
let lastGains = {};

function renderPlayers() {
  playersListDiv.innerHTML="";
  players.forEach(p => {
    const label = document.createElement("label");
    label.innerHTML = `
      <input type="checkbox" value="${p}">
      <div class="checkbox-custom">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 13L9 17L19 7" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      ${p}
    `;
    playersListDiv.appendChild(label);
    const input = label.querySelector("input");
    const customBox = label.querySelector(".checkbox-custom");
    input.addEventListener("change", () => customBox.classList.toggle("checked", input.checked));
  });
}

function updateScores() {
  scoreBoardDiv.innerHTML="";
  const sortedScores = Object.entries(scores).sort((a,b)=>b[1]-a[1]);
  sortedScores.forEach((entry,i)=>{
    const div=document.createElement("div");
    div.className="score-item";
    if(i===0) div.classList.add("winner-gold");
    else if(i===1) div.classList.add("winner-silver");
    else if(i===2) div.classList.add("winner-bronze");
    div.innerHTML=`${entry[0]}: ${entry[1]} poäng`;
    if(lastGains[entry[0]]>0){
      const gainSpan=document.createElement("span");
      gainSpan.className="score-change";
      gainSpan.textContent=`+${lastGains[entry[0]]}`;
      div.appendChild(gainSpan);
    }
    scoreBoardDiv.appendChild(div);
  });
}

function showNextStatement() {
  if(remainingStatements.length===0) { showResults(); return; }
  statementDiv.classList.add("fade-out");
  setTimeout(()=>{
    const idx=Math.floor(Math.random()*remainingStatements.length);
    let statement=remainingStatements.splice(idx,1)[0];
    currentX=Math.floor(Math.random()*5)+1;
    if(statement.includes("x")) statement=statement.replace(/x/g,currentX);
    if(statement.includes("{name}") && players.length>0){
      const randomPlayer = players[Math.floor(Math.random()*players.length)];
      statement = statement.replace(/{name}/g,randomPlayer);
    }
    statementDiv.innerHTML=statement.replace(/\n/g,"<br>");
    document.querySelectorAll("#playersList input[type=checkbox]").forEach(cb=>cb.checked=false);
    document.querySelectorAll(".checkbox-custom").forEach(box=>box.classList.remove("checked"));
    statementDiv.classList.remove("fade-out");
    statementDiv.classList.add("fade-in");
    setTimeout(()=>statementDiv.classList.remove("fade-in"),500);
    lastGains={};
    updateScores();
  },500);
}

function showResults(){
  statementDiv.innerHTML="<h2>Spelet är slut!</h2>";
  playersListDiv.innerHTML="";
  submitBtn.innerText="Tillbaka till menyn";
  updateScores();
  for(let i=0;i<100;i++){
    const c=document.createElement("div");
    c.className="confetti";
    c.style.left=Math.random()*100+"%";
    c.style.backgroundColor=`hsl(${Math.random()*360},100%,50%)`;
    c.style.animationDuration=(Math.random()*3+2)+"s";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),5000);
  }
  submitBtn.onclick=()=>window.location.href="spelare-klunk.html";
}

submitBtn.addEventListener("click",()=>{
  const selected=[];
  document.querySelectorAll("#playersList input[type=checkbox]:checked").forEach(cb=>selected.push(cb.value));
  selected.forEach(p=>{ scores[p]+=currentX; lastGains[p]=currentX; });
  showNextStatement();
});

// Återställ-knappen
resetBtn.addEventListener("click",()=>{
  players.forEach(p => scores[p]=0);
  lastGains={};
  remainingStatements=[...statements];
  updateScores();
  showNextStatement();
});

renderPlayers();
updateScores();
showNextStatement();
</script>
</body>
</html>
